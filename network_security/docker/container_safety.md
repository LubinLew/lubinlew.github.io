# 容器安全服务

容器安全服务(Container Security Service)提供容器资产管理、镜像安全及运行时入侵检测等安全服务，保障容器从镜像生成、存储到运行时的全生命周期安全，帮助企业构建容器安全防护体系。



## 为什么需要容器安全服务

在容器的生命周期中，会遇到各种风险，包括：

- 运行环境安全风险，例如，操作系统组件存在漏洞、配置不当导致暴露不必要的端口、用户访问权限不当、共享操作系统内核等风险。
- 镜像安全风险，例如，镜像存在漏洞、恶意软件、明文密钥、镜像配置不当或使用非信任镜像等风险。
- 容器安全风险，例如，容器内应用存在漏洞、被植入木马病毒，容器资源配置不当等风险。

使用容器安全服务可对上述风险进行防范，保障容器的生命周期安全。

## 产品功能

### 资产管理

容器安全服务提供自动化资产清点功能，支持清点容器、镜像、镜像仓库、主机等关键资产信息，帮助企业实现资产可视化。

### 镜像安全

容器安全服务可针对镜像、镜像仓库提供一键检测功能，支持对漏洞、木马病毒及敏感信息等多维度安全扫描。

### 运行时安全

容器安全服务支持自适应识别黑客攻击，实时监控和防护容器运行时安全，提供容器逃逸、进程黑白名单、文件访问控制等安全功能。

### 安全基线

容器安全服务支持 CIS Benchmark 标准检查，可对容器、镜像、主机等容器环境配置进行安全标准检查，多维度展现容器资产的基线合规情况并帮助建立容器运行环境下的基线配置。

### 集群安全

容器安全服务支持通过自动检查或手动检查的方式扫描集群存在的漏洞和配置风险，并对业务环境中存在风险的集群及每个集群存在的风险数据进行汇总。

---

## 轻量级部署，高性能低占用

容器安全服务采用超融合架构，具备主机安全与容器安全防护能力，支持简易安装，轻量部署。同时容器安全服务严格限制 Agent 资源占用，负载过高时主动降级保证系统正常运行，正常负载时消耗较低。

## 容器全生命周期的安全防护

在容器生命周期会遇到各种风险，容器安全服务提供容器资产管理、镜像安全及运行时入侵检测等安全服务，保障容器从镜像生成、存储到运行时的全生命周期安全，帮助企业构建容器安全防护体系。

## 可视化的安全运营分析能力

容器安全服务通过安全告警查看和响应处理等运营功能，不断为产品赋能，达到安全可视化，帮助企业提高运营能力，降低运维难度。

----

## 容器镜像防护

镜像存在应用漏洞、木马病毒及敏感信息泄露等多种安全问题， 容器安全服务支持 BUILD（构建）、SHIP（分发）、RUN（运行）全生命周期的镜像深度检查，可发现镜像存在的安全风险，并对镜像进行运行控制。容器安全服务允许用户自定义规则，实现对镜像的防护。  
![](https://main.qcloudimg.com/raw/2f419cb5b7b2420875f3e56ba3b6e019.png)

## 容器逃逸攻击检测

容器隔离性较弱，攻击者可利用敏感挂载和漏洞实现逃逸到宿主机的行为。逃逸问题直接影响承载容器底层基础设施的保密性、完整性和可用性。容器安全支持检测各类容器逃逸行为，例如：

- Privileged 特权模式运行容器引起的逃逸。
- 危险挂载导致的容器逃逸（挂载 Docker Socket、挂载宿主机 procfs）。
- 容器内进程从普通账号切换到 root 账号导致的提权。
- 容器内进程 capability 提权。
- 容器内进程突破 mount file namespace 隔离。
- 容器内进程突破 seccomp syscall 黑名单调用限制。
- 容器内进程修改未挂载进容器的宿主机文件（如 CVE-2019-5736）。

![](https://main.qcloudimg.com/raw/bc3c0572a1234e410a9acd24510c23e4.png)

---

# 功能介绍与版本对比

不同版本提供的主要功能对比如下表所示：

| **类别**   | **内容**                                                                                                                                            | **详细描述**                                                                                                                                                                             | **专业版** | **增值功能** |
| -------- | ------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------- | -------- |
| 安全概览     | 安全概览                                                                                                                                              | 以可视化的图形、图表等方式实时展示资产信息（容器、镜像、主机）、待处理安全事件数量、运行时安全事件新增趋势、本地镜像新增风险趋势及详情。                                                                                                                 | 支持      | -        |
| 资产管理     | 资产管理                                                                                                                                              | 支持自动化统计容器、镜像、主机、进程端口、应用web资产、运行应用、数据库应用等资产基本信息。                                                                                                                                      | 支持      | -        |
| 镜像安全     | 本地镜像                                                                                                                                              | - 支持定时扫描、一键扫描本地镜像获取镜像资产基本信息及镜像安全风险详情。<br>- 支持对业务环境存在风险的镜像总数、安全漏洞、木马病毒、敏感信息进行汇总。                                                                                                      | -       | 支持       |
| 仓库镜像     | - 支持定时扫描、一键扫描仓库镜像获取镜像资产基本信息及镜像安全风险详情。<br>- 支持对业务环境存在风险的镜像总数、安全漏洞、木马病毒、敏感信息进行汇总。                                                                   | -                                                                                                                                                                                    | 支持      |          |
| 集群安全     | 集群检查                                                                                                                                              | 集群检查功能提供集群检查列表、集群风险统计、集群检查详情、检查项管理等功能，通过集群检查对指定集群安装检查组件并执行风险检查，查看集群风险详情。                                                                                                             | 支持      | -        |
| 风险分析     | 风险分析功能展示集群检查发现的所有风险项和风险统计，包括风险节点趋势以及风险项信息，提供详细风险详情、风险描述、解决方案以及风险的影响范围。                                                                            | 支持                                                                                                                                                                                   | -       |          |
| 运行时安全    | 容器逃逸                                                                                                                                              | - 支持实时检测容器内存在的宿主机文件访问逃逸、MountNamespace 逃逸、程序提权逃逸、特权容器启动逃逸、敏感路径挂载、Syscall 逃逸等容器逃逸行为。<br>- 告警信息包括：逃逸事件类型、首次生成时间、最近生成时间、事件数量、容器名称/ID、镜像名称/ID、节点名称、POD 名称等。<br>- 同时告警详情提供进程信息和事件描述等详细信息。 | 支持      | -        |
| 反弹 Shell | - 支持实时检测容器内存在的反弹 Shell 行为并产生告警。<br>- 告警信息包括：进程名称、父进程名称、目标地址、进程路径、首次生成时间、最近生成时间、事件数量、容器名称/ID、镜像名称/ID等。<br>- 同时告警详情提供进程和父进程详细信息，支持自定义白名单。           | 支持                                                                                                                                                                                   | -       |          |
| 高级防御     | 异常进程                                                                                                                                              | - 支持实时检测容器内存在的进程异常启动行为并告警通知或拦截异常进程。<br>- 告警信息包括：进程路径、命中规则、首次生成时间、最近生成时间、事件数量、容器名称/ID、镜像名称/ID、动作执行结果等。<br>- 同时告警详情提供进程和父进程详细信息，支持自定义配置检测规则。                                           | 支持      | -        |
| 文件篡改     | - 支持实时检测容器内存在的文件异常篡改行为并告警通知或拦截异常访问。<br>- 告警信息包括：文件名称、进程路径、命中规则、首次生成时间、最近生成时间、事件数量、容器名称/ID、镜像名称/ID、动作执行结果等。<br>- 同时告警详情提供进程和被篡改文件详细信息，支持自定义配置检测规则。 | 支持                                                                                                                                                                                   | -       |          |
| 高危系统调用   | - 支持实时检测容器内存在的高危系统调用行为并产生告警。<br>- 告警信息包括：进程路径、系统调用名称、首次生成时间、最近生成时间、事件数量、容器名称/ID、镜像名称/ID、节点名称、POD 名称等。<br>- 同时告警详情提供进程和父进程详细信息，支持自定义白名单。           | 支持                                                                                                                                                                                   | -       |          |
| 安全基线     | 安全基线                                                                                                                                              | - 支持 CIS Benchmark 基线检查标准，检测 Docker 及 kubernetes 安全基线，并对业务环境中合规容器占比、严重检查项、高危检查项、中危检查项、低危检查项进行统计。<br>- 基线检测结果包括基线检测项、类型、基线标准、威胁等级、检测结果、检测项详情等，检测对象包括容器、镜像、主机和 kubernetes。             | 支持      | -        |
| 安全运营     | 告警设置                                                                                                                                              | 支持告警设置，对镜像安全事件和运行时安全事件配置告警策略。                                                                                                                                                        | 支持      | -        |