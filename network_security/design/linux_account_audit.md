# Linux 账号变更审计

Linux 账号变更的日志存储于 CentOS(`/var/log/secure`) Ubuntu(`/var/log/auth.log`) 文件中。

| 类型      | 涉及命令                                | 说明              | 日志例子                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| ------- | ----------------------------------- | --------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 新增用户    | useradd                             | 新建用户同时也会新建同名用户组 | Dec  1 10:56:22 hostname useradd[30655]: new group: name=`test5`, GID=1007<br/>Dec  1 10:56:22 hostname useradd[30655]: new user: name=`test5`, UID=1006, GID=1007, home=/home/test5, shell=/bin/bash                                                                                                                                                                                                                                                                     |
| 删除用户    | userdel                             | 删除用户同时也会删除同名用户组 | Dec  1 11:03:43 hostname userdel[1555]: delete user 'test1'<br/>Dec  1 11:03:43 hostname userdel[1555]: removed group '`test1`' owned by '`test1`'<br/>Dec  1 11:03:43 hostname userdel[1555]: removed shadow group '`test1`' owned by '`test1`'                                                                                                                                                                                                                          |
| 变更用户信息  | usermod<br>chfn - 无日志<br>chsh - 无日志 | -               | Dec  1 13:16:50 hostname usermod[13365]: change user '`test11`' home from '/home/test11' to '/tmp/'<br/>Dec  2 09:44:28 hostname usermod[32374]: change user '`test3`' shell from '/usr/bin/bash' to '/bin/sh'                                                                                                                                                                                                                                                            |
| 变更用户密码  | passwd                              | -               | Dec  2 14:43:14 hostname passwd: pam_unix(passwd:chauthtok): password changed for `test3`                                                                                                                                                                                                                                                                                                                                                                                 |
| 新增用户组   | groupadd                            | useradd 也会新增用户组 | Dec  1 13:16:50 hostname groupadd[13375]: group added to /etc/group: name=`testg11`, GID=1009<br/>Dec  1 13:16:50 hostname groupadd[13375]: group added to /etc/gshadow: name=`testg11`<br/>Dec  1 13:16:50 hostname groupadd[13375]: new group: name=`testg11`, GID=1009                                                                                                                                                                                                 |
| 删除用户组   | groupdel                            | -               | Dec  1 13:16:50 hostname groupdel[13383]: group '`testg11`' removed from /etc/group<br/>Dec  1 13:16:50 hostname groupdel[13383]: group '`testg11`' removed from /etc/gshadow<br/>Dec  1 13:16:50 hostname groupdel[13383]: group '``testg11`' removed                                                                                                                                                                                                                    |
| 变更用户组信息 | groupmod                            | 一条命令2条日志        | Dec  1 13:16:50 hostname groupmod[13379]: group changed in /etc/group (group `testg11`/1009, new password)<br/>Dec  1 13:16:50 hostname groupmod[13379]: group changed in /etc/gshadow (group `testg11`, new password)                                                                                                                                                                                                                                                    |
| 变更用户组权限 | gpasswd                             | 可以通过选项修改各种权限    | Dec  2 13:21:40 hostname gpasswd[7220]: administrators of group `test3` set by root to `test3`<br/>Dec  2 13:22:45 hostname gpasswd[7224]: members of group `test3` set by root to `test4`<br/>Dec  2 13:23:12 hostname gpasswd[8833]: user `test4` removed by root from group `test3`<br/>Dec  2 13:23:30 hostname gpasswd[8837]: user `test4` added by `root` to group `test3`<br/>Dec  2 13:24:21 hostname gpasswd[8841]: password of group ``test3` removed by `root` |


